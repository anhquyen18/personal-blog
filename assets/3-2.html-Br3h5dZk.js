import{_ as e,a as i,b as s,c as n,d as a,e as t,f as o,g as l,h as r,i as c,j as p,k as d,l as u,m as g,n as h,o as m,p as y,q as k,r as f}from"./iam-2_19-BR5lff1T.js";import{_ as A}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as B,o as v,e as C}from"./app-BDQXVHS9.js";const b={},E=C('<h3 id="introduction" tabindex="-1"><a class="header-anchor" href="#introduction"><span>Introduction</span></a></h3><p>IAM Policies in AWS are JSON documents that define access permissions and access restrictions for users, groups, and roles in AWS. These policies dictate what actions are allowed or denied on specific AWS resources.</p><ul><li><p>IAM Policy is an important tool for managing security and access control in AWS. These policies identify:</p><ul><li>Who (user, user group, role) can perform the action.</li><li>What (AWS API actions) can they perform.</li><li>Which (specific AWS resources) actions can be performed.</li><li>When and Which Conditions (specific conditions) apply to the action.</li></ul></li><li><p>Types of IAM Policy:</p><ul><li><strong>Managed Policies</strong>: Policies are managed by AWS or created and managed by you. <ul><li>AWS Managed Policies: Created and managed by AWS, updated automatically when there are new features or changes in AWS services.</li><li>Customer Managed Policies: Created and managed by you. Allows detailed customization of permissions.</li></ul></li><li><strong>Inline Policies</strong>: Policies are attached directly to a user, group or role. These policies cannot be reused and must be managed individually. Not recommended unless there is a clear purpose.</li></ul></li><li><p>Some notes when using IAM Policy</p></li></ul><ol><li><p>Principle of Least Privilege:</p><ul><li>Only grant the minimum permissions to perform the job.</li><li>Avoid assigning permissions that are too broad, such as &quot;*&quot; for all actions or resources.</li></ul></li><li><p>Use AWS Managed Policies when possible:</p><ul><li>Use AWS managed policies to ensure you always have the most up-to-date and secure permissions.</li></ul></li><li><p>Check and update policies periodically::</p><ul><li>Make sure policies stay aligned with current business requirements and don&#39;t have unnecessary permissions.</li></ul></li><li><p>Using Conditions:</p><ul><li>Use conditions in policies to granularly control access based on attributes like IP address, time, MFA, and more.</li></ul></li><li><p>Monitoring and logging:</p><ul><li>Use AWS CloudTrail and AWS Config to monitor and log IAM-related activities and changes.</li></ul></li></ol><h3 id="create-customer-managed-policy" tabindex="-1"><a class="header-anchor" href="#create-customer-managed-policy"><span>Create Customer managed Policy</span></a></h3><p>We will create a Policy that will be attached to the user group <em>DevGroup</em>. And test some actions with AWS resources through the user we created.</p><p>Create a policy allows to only create EC2 in the <em>Singapore (ap-southeast-1)</em> region, and only create instances with instance type starting with <em>t2.</em> to avoid creating excessive instances, which leading to the cost is too great.</p><ol><li>In the <a href="https://console.aws.amazon.com/iam" target="_blank" rel="noopener noreferrer">AWS IAM</a> console, select <strong>Policies</strong>, click <strong>Create policy</strong>.</li></ol><figure><img src="'+e+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ol start="2"><li>Select <strong>JSON</strong>. Add code to Policy editor.</li></ol><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="shiki shiki-themes github-light one-dark-pro vp-code" style="background-color:#fff;--shiki-dark-bg:#282c34;color:#24292e;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#E06C75;">  &quot;Version&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#032F62;--shiki-dark:#98C379;">&quot;2012-10-17&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#E06C75;">  &quot;Statement&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: [</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">    {</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#E06C75;">      &quot;Effect&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#032F62;--shiki-dark:#98C379;">&quot;Allow&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#E06C75;">      &quot;Action&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="color:#032F62;--shiki-dark:#98C379;">&quot;ec2:RunInstances&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="color:#032F62;--shiki-dark:#98C379;">&quot;ec2:CreateTags&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#E06C75;">      &quot;Resource&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#032F62;--shiki-dark:#98C379;">&quot;*&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#E06C75;">      &quot;Condition&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#E06C75;">        &quot;StringEquals&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#E06C75;">          &quot;aws:RequestedRegion&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#032F62;--shiki-dark:#98C379;">&quot;ap-southeast-1&quot;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">      }</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">    },</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">    {</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#E06C75;">      &quot;Effect&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#032F62;--shiki-dark:#98C379;">&quot;Deny&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#E06C75;">      &quot;Action&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#032F62;--shiki-dark:#98C379;">&quot;ec2:RunInstances&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#E06C75;">      &quot;Resource&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#032F62;--shiki-dark:#98C379;">&quot;arn:aws:ec2:*:*:instance/*&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#E06C75;">      &quot;Condition&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#E06C75;">        &quot;StringNotLike&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#E06C75;">          &quot;ec2:InstanceType&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#032F62;--shiki-dark:#98C379;">&quot;t2.*&quot;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">      }</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">    },</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">    {</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#E06C75;">      &quot;Effect&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#032F62;--shiki-dark:#98C379;">&quot;Allow&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#E06C75;">      &quot;Action&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#032F62;--shiki-dark:#98C379;">&quot;ec2:Describe*&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#E06C75;">      &quot;Resource&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#032F62;--shiki-dark:#98C379;">&quot;*&quot;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">  ]</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>Statement 1: We need to create tags with ec2.</p><ul><li>Effect: Allow – Allows action.</li><li>Action: ec2:RunInstances, ec2:CreateTags – Only allows to run EC2 instances and create tags.</li><li>Resource: * – Applies to all resources.</li><li>Conditions: <ul><li>StringEquals – Use condition to limit implementation in ap-southeast-1 (Singapore) region.</li></ul></li></ul></li><li><p>Statement 2:</p><ul><li>Effect: Deny – Refuses action.</li><li>Action: ec2:RunInstances.</li><li>Resource: arn:aws:ec2:ap-southeast-1::instance/* – Specifies the resource type.</li><li>Condition: <ul><li>StringNotLike: Limits instance types starting with t2.</li></ul></li></ul></li><li><p>Statement 3:</p><ul><li>Effect: Allow – Allows action.</li><li>Action: Allows EC2 descriptions so users can view the information needed to create EC2 instances, including - regions, images, key pairs, security groups, subnets, and VPCs.</li><li>Resource: * – Applies to all resources.</li></ul></li></ul><figure><img src="`+i+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ol start="3"><li>Scroll down and click <strong>Next</strong>.</li></ol><figure><img src="'+s+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ol start="4"><li>Enter policy name <em>OurAccessControl</em>.</li></ol><figure><img src="'+n+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ol start="5"><li>Review the permissions of the json code we just added, then click <strong>Create policy</strong>.</li></ol><figure><img src="'+a+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ol start="6"><li>Policy is created successfully.</li></ol><figure><img src="'+t+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="attaching-policy-to-user-group" tabindex="-1"><a class="header-anchor" href="#attaching-policy-to-user-group"><span>Attaching policy to user group</span></a></h3><ul><li><p>We will attach to the group instead of directly to the user for the following reasons:</p><ul><li><strong>Easy management and maintenance</strong>: Once policies are attached to a group, you only need to update that group when permissions need to be changed. All users in that group will automatically receive updated permissions without the need to configure each user individually.</li><li><strong>Consistency</strong>: Ensure that all users in the same group have consistent permissions. This helps avoid confusion and errors when configuring permissions for individual users.</li><li><strong>Save time</strong>: Attaching policies to groups helps reduce the time needed to manage permissions. You just need to add users to groups instead of setting permissions for each individual user.</li><li><strong>Scalability</strong>: As your organization grows, you can easily add users to existing groups without having to reconfigure permissions for each new user.</li><li><strong>Enhanced security</strong>: Managing policies through groups makes it easier to control and track permissions. This helps ensure that permissions are managed systematically and in compliance with the organization&#39;s security policies.</li><li><strong>Delegation of permissions and responsibilities</strong>: Allows administrators to delegate management permissions to different groups to different departments or work groups, creating a clear division of responsibility for access management access.</li></ul></li></ul><ol><li>In the <a href="https://console.aws.amazon.com/iam" target="_blank" rel="noopener noreferrer">IAM</a> console, select <em>User groups</em>, select <em>DevGroup</em>.</li></ol><p>AWS warns us that we have not defined any policy for the group.</p><figure><img src="'+o+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ol start="2"><li>Switch to the <strong>Permissions</strong> tab, select <strong>Add permissions</strong>, select <strong>Attach policies</strong>.</li></ol><figure><img src="'+l+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ol start="3"><li>Search for the policy we created, select the policy then click <strong>Attach policies</strong>.</li></ol><figure><img src="'+r+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ol start="4"><li>Policy is attached successfully.</li></ol><figure><img src="'+c+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="check-ec2-accessibility-of-the-user" tabindex="-1"><a class="header-anchor" href="#check-ec2-accessibility-of-the-user"><span>Check EC2 accessibility of the user.</span></a></h3><p>Log in to the created user, then access the <a href="https://console.aws.amazon.com/ec2" target="_blank" rel="noopener noreferrer">EC2</a> console, we will try to create an instance in the N. Virginia region.</p><ol><li>In the console, click <strong>Launch instances</strong>.</li></ol><figure><img src="'+p+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ol start="2"><li><p>Set up EC2.</p><ul><li>Name and tags: <em>test-ec2</em>.</li><li>Instance type: <em>t2.micro</em>.</li><li>Key pair: <em>Proceed without a key pair</em>.</li><li>Network settings: Select <strong>Select existing security group</strong>, select <strong>default</strong>.</li><li>Leave remaining parameters as default.</li><li>Click <strong>Launch instance</strong>.</li></ul></li></ol><figure><img src="'+d+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ol start="3"><li>Unable to create EC2.</li></ol><p>The message shows an error, we cannot create an EC2 instance on the <em>us-east-1 (N. Virginia)</em> region. Click <strong>Cancle</strong>.</p><figure><img src="'+u+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ol start="4"><li>Switch region to Singapore and click <strong>Launch instance</strong> again.</li></ol><figure><img src="'+g+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ol start="5"><li><p>Set up EC2.</p><ul><li>Name and tags: <em>test-ec2</em>.</li><li>Instance type: <em>t3.nano</em>.</li><li>Network settings: Select <strong>Select existing security group</strong>, select <strong>default</strong>.</li><li>Leave remaining parameters as default.</li><li>Click <strong>Launch instance</strong></li></ul></li></ol><figure><img src="'+h+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ol start="6"><li>We get the same error in the previous step.</li></ol><p>Because we have selected instance type <em>t3.nano</em>, which is outside the policy conditions.</p><p>Click <strong>Edit instance config</strong>.</p><figure><img src="'+m+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ol start="7"><li>Reselect <em>t2.micro</em> type or any t2 type depending on you, then <strong>Launch instance</strong> again.</li></ol><figure><img src="'+y+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ol start="8"><li>Instance is created successfully. We will use this instance for the next example.</li></ol><figure><img src="'+k+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="'+f+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>So we have learned how to limit EC2 resources created by users, you can replace EC2 with other AWS resources to suit reality.</p>',55),w=[E];function S(q,_){return v(),B("div",null,w)}const I=A(b,[["render",S],["__file","3-2.html.vue"]]),x=JSON.parse('{"path":"/en/posts/AWS/prevent-security-risks/access-control/3-2.html","title":"3.2 Explore IAM Policy","lang":"en-US","frontmatter":{"date":"2024-06-24T00:00:00.000Z","article":false,"title":"3.2 Explore IAM Policy","lastUpdated":true,"category":["AWS"],"tag":["Security","Organization","IAM","EventBridge","Budget","Guide"],"description":"Introduction IAM Policies in AWS are JSON documents that define access permissions and access restrictions for users, groups, and roles in AWS. These policies dictate what actio...","head":[["link",{"rel":"alternate","hreflang":"vi-vn","href":"https://www.linkedin.com/in/anh-quyen-tran-188394216/personal-blog/posts/AWS/prevent-security-risks/access-control/3-2.html"}],["meta",{"property":"og:url","content":"https://www.linkedin.com/in/anh-quyen-tran-188394216/personal-blog/en/posts/AWS/prevent-security-risks/access-control/3-2.html"}],["meta",{"property":"og:site_name","content":"Tran Anh Quyen"}],["meta",{"property":"og:title","content":"3.2 Explore IAM Policy"}],["meta",{"property":"og:description","content":"Introduction IAM Policies in AWS are JSON documents that define access permissions and access restrictions for users, groups, and roles in AWS. These policies dictate what actio..."}],["meta",{"property":"og:type","content":"website"}],["meta",{"property":"og:image","content":"https://www.linkedin.com/in/anh-quyen-tran-188394216/personal-blog/storage/prevent-security-risks/iam-2_1.png"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:locale:alternate","content":"vi-VN"}],["meta",{"property":"og:updated_time","content":"2024-07-02T08:40:48.000Z"}],["meta",{"property":"article:author","content":"Tran Anh Quyen"}],["meta",{"property":"article:tag","content":"Security"}],["meta",{"property":"article:tag","content":"Organization"}],["meta",{"property":"article:tag","content":"IAM"}],["meta",{"property":"article:tag","content":"EventBridge"}],["meta",{"property":"article:tag","content":"Budget"}],["meta",{"property":"article:tag","content":"Guide"}],["meta",{"property":"article:published_time","content":"2024-06-24T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-07-02T08:40:48.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"WebPage\\",\\"name\\":\\"3.2 Explore IAM Policy\\",\\"description\\":\\"Introduction IAM Policies in AWS are JSON documents that define access permissions and access restrictions for users, groups, and roles in AWS. These policies dictate what actio...\\"}"]]},"headers":[{"level":3,"title":"Introduction","slug":"introduction","link":"#introduction","children":[]},{"level":3,"title":"Create Customer managed Policy","slug":"create-customer-managed-policy","link":"#create-customer-managed-policy","children":[]},{"level":3,"title":"Attaching policy to user group","slug":"attaching-policy-to-user-group","link":"#attaching-policy-to-user-group","children":[]},{"level":3,"title":"Check EC2 accessibility of the user.","slug":"check-ec2-accessibility-of-the-user","link":"#check-ec2-accessibility-of-the-user","children":[]}],"git":{"createdTime":1719909648000,"updatedTime":1719909648000,"contributors":[{"name":"Pai18","email":"anhquyen18092000@gmail.com","commits":1}]},"readingTime":{"minutes":3.81,"words":1143},"filePathRelative":"en/posts/AWS/prevent-security-risks/access-control/3-2.md","localizedDate":"June 24, 2024","excerpt":"<h3>Introduction</h3>\\n<p>IAM Policies in AWS are JSON documents that define access permissions and access restrictions for users, groups, and roles in AWS. These policies dictate what actions are allowed or denied on specific AWS resources.</p>\\n<ul>\\n<li>\\n<p>IAM Policy is an important tool for managing security and access control in AWS. These policies identify:</p>\\n<ul>\\n<li>Who (user, user group, role) can perform the action.</li>\\n<li>What (AWS API actions) can they perform.</li>\\n<li>Which (specific AWS resources) actions can be performed.</li>\\n<li>When and Which Conditions (specific conditions) apply to the action.</li>\\n</ul>\\n</li>\\n<li>\\n<p>Types of IAM Policy:</p>\\n<ul>\\n<li><strong>Managed Policies</strong>: Policies are managed by AWS or created and managed by you.\\n<ul>\\n<li>AWS Managed Policies: Created and managed by AWS, updated automatically when there are new features or changes in AWS services.</li>\\n<li>Customer Managed Policies: Created and managed by you. Allows detailed customization of permissions.</li>\\n</ul>\\n</li>\\n<li><strong>Inline Policies</strong>: Policies are attached directly to a user, group or role. These policies cannot be reused and must be managed individually. Not recommended unless there is a clear purpose.</li>\\n</ul>\\n</li>\\n<li>\\n<p>Some notes when using IAM Policy</p>\\n</li>\\n</ul>","autoDesc":true}');export{I as comp,x as data};
